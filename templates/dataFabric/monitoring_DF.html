{% extends 'base.html' %}
{% block content %}
{% load static %}

<!-- BEGIN content -->
<div id="content" class="app-content" style="padding: 1rem !important;">
    <div class="container">
        <div class="row justify-content-center">
            <!-- BEGIN col-xl-10 -->
            <div class="col-xl-10">
                <div class="row">
                    <!-- BEGIN col-xl-6 -->
                    <div class="col-xl-6 mb-3">
                        <div class="d-flex h-30px form-control form-control-lg bg-white bg-opacity-25 mb-1 fs-12px p-0 w-200px  text-white align-items-center justify-content-center">
                            Database traffic
                        </div>
                        <div class="form-control form-control-lg bg-white bg-opacity-10 h-190px">
                            <div id="databaseConnectChart" class="mt-n3 mb-n2" ></div>
                        </div>
                    </div>
                    <!-- END col-xl-6 -->

                    <!-- BEGIN col-xl-6 -->
                    <div class="col-xl-6">
                        <div class="d-flex h-30px form-control form-control-lg bg-white bg-opacity-25 mb-1 fs-12px p-0 w-200px  text-white align-items-center justify-content-center">
                            User traffic
                        </div>
                        <div class="form-control form-control-lg bg-white bg-opacity-10 h-190px">
                            <div id="UserConnectChart"></div>
                        </div>
                    </div>
                    <!-- END col-xl-6 -->

                    <!-- END col-xl-12 -->
                    <div class="col-xl-12">
                        <div class="d-flex h-30px form-control form-control-lg bg-white bg-opacity-25 mb-1 fs-12px p-0 w-200px  text-white align-items-center justify-content-center">
                            Database CPU traffic
                        </div>
                        <div class="form-control form-control-lg bg-white bg-opacity-10 h-240px mb-3">
                            <div id="CpuUsageChart" class="mt-n3 mb-n2"></div>
                        </div>
                    </div>
                    <!-- END col-xl-12 -->

                    <!-- END col-xl-12 -->
                    <div class="col-xl-12">
                        <div class="d-flex h-30px form-control form-control-lg bg-white bg-opacity-25 mb-1 fs-12px p-0 w-200px  text-white align-items-center justify-content-center">
                            Query History
                        </div>
                        <div class="form-control form-control-lg bg-white bg-opacity-10 h-295px">
                        <!-- BEGIN monitoring-table -->
                            <table id="queryHistoryTable" class="table table-bordered dataFabricTable-sm QueryHistoryTable fs-12px">
                                <thead>
                                    <tr class="table-dark">
                                        <th>Timestamp</th>
                                        <th>DB Name</th>
                                        <th>Database</th>
                                        <th>Table</th>
                                        <th>User</th>
                                        <th>Query</th>
                                        <th>Result</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for historydata in history %}
                                    <tr>
                                        <td>{{historydata.commit_time|date:'Y-m-d H:i'}}</td>
                                        <td>{{historydata.dbname}}</td>
                                        <td>{{historydata.dbtype}}</td>
                                        <td>{{historydata.dbtable}}</td>
                                        <td>{{historydata.db_user}}</td>
                                        <td>{{historydata.db_query}}</td>
                                        <td>{{historydata.db_result}}</td>
                                    </tr>
                                    {% endfor %}
<!--                                        <tr>-->
<!--                                            <td>2023-01-27 14:20:22</td>-->
<!--                                            <td></td>-->
<!--                                            <td>Postgres</td>-->
<!--                                            <td>Statistics</td>-->
<!--                                            <td>Guest</td>-->
<!--                                            <td>DROP TABLE Statistic</td>-->
<!--                                            <td>SUCCES ROWS</td>-->
<!--                                        </tr>-->
                                </tbody>
                            </table>
                        <!-- END monitoring-table -->
                        </div>
                    </div>
                    <!-- END col-xl-12 -->
                </div>
            </div>
            <!-- END col-xl-10 -->
        </div>
    </div>
</div>
<!-- END content -->
<script>
    var db_traffic = {{db_traffic | safe}};
    var user_traffic = {{user_traffic | safe}};
    var cpu_traffic = {{ cpu_traffic | safe}};
    console.log(cpu_traffic);
</script>
{% endblock %}